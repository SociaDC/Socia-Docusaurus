"use strict";(self.webpackChunkproject_documentation=self.webpackChunkproject_documentation||[]).push([[495],{7812:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var o=r(4848),s=r(8453);const i={sidebar_position:3,description:"Docker Guide",author:"Philipp Cserich"},t="Docker usage & Best Practices",a={id:"knowledgebase/docker-paper",title:"Docker usage & Best Practices",description:"Docker Guide",source:"@site/docs/knowledgebase/docker-paper.md",sourceDirName:"knowledgebase",slug:"/knowledgebase/docker-paper",permalink:"/docs/knowledgebase/docker-paper",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/knowledgebase/docker-paper.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"Docker Guide",author:"Philipp Cserich"},sidebar:"tutorialSidebar",previous:{title:"Gitops principle",permalink:"/docs/knowledgebase/gitops-paper"}},l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"What is Docker",id:"what-is-docker",level:2},{value:"How to use Docker / Useful commands and Installation",id:"how-to-use-docker--useful-commands-and-installation",level:2},{value:"Dockerfile &amp; Images",id:"dockerfile--images",level:2},{value:"Dockerfile Structure",id:"dockerfile-structure",level:3},{value:"Single Stage Build",id:"single-stage-build",level:4},{value:"Multi Stage Build",id:"multi-stage-build",level:4},{value:"Docker compose file",id:"docker-compose-file",level:2},{value:"Docker network",id:"docker-network",level:3},{value:"Volumes",id:"volumes",level:2},{value:"Interactive Container Work",id:"interactive-container-work",level:2},{value:"Pushing Images",id:"pushing-images",level:2},{value:"Custom Registry",id:"custom-registry",level:3},{value:"Links &amp; Ressources",id:"links--ressources",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"docker-usage--best-practices",children:"Docker usage & Best Practices"})}),"\n",(0,o.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.p,{children:"This Docker guide is written for Socia/Phobos developers only, all usages or publications outside of project reach are not allowed and therefore this document restrains in terms restricted access."}),"\n",(0,o.jsx)(n.h2,{id:"what-is-docker",children:"What is Docker"}),"\n",(0,o.jsx)(n.p,{children:"If you are already familiar with Virtual Machines you will understand the concept of docker out of the box."}),"\n",(0,o.jsx)(n.p,{children:'Docker is basicly a lightweight VM, in normal language that means that docker provides a way to encapsulate your software into a so called container.\nContainers are Simulating the OS Layer of your PC without creating a virtual kernel. (Still uses existing ressources)\nThis is especially usefull when thinking about reproducability.\nThe saying "It works on my PC" will never be an excuse from now on, because once containerized a Software will always be able to maintain state unable of its undelying system.'}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"(Ignore the fact that cost expensive containers will obviously not run on a shitty PC)"})}),"\n",(0,o.jsx)(n.h2,{id:"how-to-use-docker--useful-commands-and-installation",children:"How to use Docker / Useful commands and Installation"}),"\n",(0,o.jsxs)(n.p,{children:["Docker as a system is linux native. That requires Windows PCs to use the WSL.\nOur most powerful tools will be ",(0,o.jsx)(n.strong,{children:"$ docker run"})," and ",(0,o.jsx)(n.strong,{children:"$ docker build"})]}),"\n",(0,o.jsxs)(n.p,{children:["Installing it can be done by using the official enterprise Software ",(0,o.jsx)(n.strong,{children:"Docker Desktop"})," or for any Open source lowers, ",(0,o.jsx)(n.strong,{children:"Podman Desktop"})," could be worth a try."]}),"\n",(0,o.jsx)(n.h2,{id:"dockerfile--images",children:"Dockerfile & Images"}),"\n",(0,o.jsx)(n.p,{children:"A Dockerfile is Dockers soul. It creates one place where all necessary build information is stored.\nThese infos will get used to build your application in every way you could possibly imagine.\nWant an NGINX got it! Or just a node Server? No Problem!"}),"\n",(0,o.jsx)(n.p,{children:"This singular information dump is used by the docker daemon to create a technical blueprint that represents all requirements.\nThe so called image. Therefore every Application that needs to run in a containerized environment needs an image.\nThere are many ways to obtain such images. One would be to create your own with a custom dockerfile as explained before.\nBut you can also choose one of the many prebuilt docker images from dockerhub.\nDockerhub represents a marketplace for docker images, in all forms and colors.\nIf you want to check it out the link will be provided below."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://hub.docker.com/",children:"https://hub.docker.com/"})}),"\n",(0,o.jsx)(n.p,{children:"The exact workflow for every containerization can be displayed as follows."}),"\n",(0,o.jsx)(n.p,{children:"Dockerfile -> Docker image -> Docker Container"}),"\n",(0,o.jsx)(n.h3,{id:"dockerfile-structure",children:"Dockerfile Structure"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'FROM image:tag\n\nRUN sh command xy\n\nENTRYPOINT ["",""] #entrypoint for built image / Not Changable\n\nCOPY . . #From To\n\n#Makes the specified ports accessable to the containers outside (Localhost)\nEXPOSE 80/tcp\nEXPOSE 80/udp\n'})}),"\n",(0,o.jsx)(n.h4,{id:"single-stage-build",children:"Single Stage Build"}),"\n",(0,o.jsx)(n.p,{children:"Normally you will just include all necessary steps to install the env. as needed in one stage.\nThis is the easier route of creating images, because of its straight nature.\nThe build normally also includes all unnecessary build / installation step files such as node module folders or java dependency packages."}),"\n",(0,o.jsx)(n.h4,{id:"multi-stage-build",children:"Multi Stage Build"}),"\n",(0,o.jsx)(n.p,{children:"Appart from building a docker env completely in one single session you can create something called a multi stage build dockerfile.\nThis version of a dockerfile uses the copy feature to create necessary ressources over one session and execute them on the other.\nInstead of maintaining unnecessary ressources, this approach lets you aboard all unnecessary file mud that gets created when installing or creating your executable software."}),"\n",(0,o.jsx)(n.p,{children:"One example could be to build a maven application (Socia) with such approach."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'FROM openjdk:22 as builder\nLABEL maintainer#"Philipp Cserich, Thomas Boigner"\nARG JAR_FILE#target/*.jar\nCOPY ${JAR_FILE} application.jar\nRUN java -Djarmode#layertools -jar application.jar extract\n\nFROM openjdk:22\nLABEL maintainer#"Philipp Cserich, Thomas Boigner"\nCOPY --from#builder dependencies/ ./\nRUN true\n# COPY --from#builder internal-dependencies/ ./\nCOPY --from#builder snapshot-dependencies/ ./\nRUN true\nCOPY --from#builder spring-boot-loader/ ./\nRUN true\nCOPY --from#builder application/ ./\nENTRYPOINT ["java", "org.springframework.boot.loader.launch.JarLauncher"]\n'})}),"\n",(0,o.jsx)(n.h2,{id:"docker-compose-file",children:"Docker compose file"}),"\n",(0,o.jsx)(n.p,{children:"Docker compose is used to create a more broad service structure and simple way to start multiple services that need to cooperate with eachother."}),"\n",(0,o.jsx)(n.h3,{id:"docker-network",children:"Docker network"}),"\n",(0,o.jsxs)(n.p,{children:["Containers normally all have their own localhost running internally, therfore service structures can no longer work by calling the localhost.\nThe solutions are docker networks. They group the containers logically, so that they can reach each other per DNS entry over their service name.\nFor example the service ",(0,o.jsx)(n.strong,{children:"APP1"})," needs to call the service ",(0,o.jsx)(n.strong,{children:"APP2"})," over the port 8080. to do that it has to use"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"ping APP2:8080\n"})}),"\n",(0,o.jsx)(n.h2,{id:"volumes",children:"Volumes"}),"\n",(0,o.jsx)(n.p,{children:"Volumes are persistent modules which have to maintain outside of the containers runtime.\nThis includes files for startup configurations or other db / persistent files."}),"\n",(0,o.jsx)(n.p,{children:"They are specified by using :"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"service:\n  volumes: # Persistent data\n      - volume-name:/var/lib/mysql\nvolumes:\n  volume-name: #Can also be empty\n    driver: local #Optional spec\n"})}),"\n",(0,o.jsx)(n.h2,{id:"interactive-container-work",children:"Interactive Container Work"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"docker exec -it ...\n"})}),"\n",(0,o.jsx)(n.p,{children:"(TODO)"}),"\n",(0,o.jsx)(n.h2,{id:"pushing-images",children:"Pushing Images"}),"\n",(0,o.jsx)(n.h3,{id:"custom-registry",children:"Custom Registry"}),"\n",(0,o.jsx)(n.h2,{id:"links--ressources",children:"Links & Ressources"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["01 ",(0,o.jsx)(n.a,{href:"https://hub.docker.com/",children:"Dockerhub"})]}),"\n",(0,o.jsxs)(n.li,{children:["02 ",(0,o.jsx)(n.a,{href:"https://docs.docker.com/",children:"Docker Documentation"})]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var o=r(6540);const s={},i=o.createContext(s);function t(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);